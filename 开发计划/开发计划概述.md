# Chips-Viewer 开发计划概述

**版本**：1.0.0  
**创建日期**：2026-02-01  
**项目名称**：薯片卡片查看器 (Chips-Viewer)

---

## 一、项目概述

### 1.1 产品定位

Chips-Viewer 是薯片生态系统中的轻量级查看应用，用于浏览和查看卡片（.card）和箱子（.box）文件。它采用**插件优先**的设计理念，通过调用 Foundation 层的渲染服务实现核心功能。

### 1.2 核心职责

- **内容展示调度**：通过微内核路由调用 Foundation 层的 CardRenderer 和 BoxRenderer
- **插件管理**：管理查看工具插件的安装、卸载、更新和调度
- **用户交互**：提供导航、缩放、搜索、主题切换等交互功能
- **窗口管理**：管理 iframe 内容的显示和布局
- **平台适配**：支持桌面（Electron）和 Web 平台

### 1.3 设计原则

1. **中心路由原则**：所有模块间通信必须经过 Chips Core 路由器
2. **公共基础层依赖**：查看工具来自 Foundation 层，Viewer 不自行实现渲染逻辑
3. **插件优先**：核心查看功能以插件形式提供，支持热插拔
4. **前后端分离**：前端处理 UI 和交互，后端处理业务逻辑
5. **零硬编码**：所有文本使用多语言系统，所有样式由主题包控制

---

## 二、依赖关系

### 2.1 项目依赖

| 依赖项 | 版本要求 | 说明 |
|--------|---------|------|
| @chips/core | ^1.0.0 | 薯片微内核，提供路由能力 |
| @chips/foundation | ^1.0.0 | 公共基础层，提供渲染服务 |
| @chips/sdk | ^1.0.0 | 开发工具包，封装底层 API |
| @chips/components | ^0.1.0 | 组件库，提供 UI 组件 |

### 2.2 架构层级

```
┌─────────────────────────────────────┐
│       Chips-Viewer (本项目)          │
└──────────────┬──────────────────────┘
               │
┌──────────────┴──────────────────────┐
│   @chips/sdk + @chips/components     │
└──────────────┬──────────────────────┘
               │
┌──────────────┴──────────────────────┐
│       @chips/foundation              │
└──────────────┬──────────────────────┘
               │
┌──────────────┴──────────────────────┐
│         @chips/core                  │
└─────────────────────────────────────┘
```

---

## 三、开发阶段规划

### 阶段一：项目初始化与基础架构（5天）

**目标**：搭建项目骨架，配置开发环境，实现基础架构

1. 项目初始化与配置
2. 目录结构创建
3. 核心类型定义
4. 基础服务层实现
5. 与 SDK/Core 的连接层

### 阶段二：核心模块开发（7天）

**目标**：实现核心业务模块

1. ViewerApp 主类实现
2. NavigationController 导航控制器
3. CardManager 卡片管理器
4. BoxManager 箱子管理器
5. StateManager 状态管理
6. ConfigManager 配置管理

### 阶段三：插件系统与渲染集成（6天）

**目标**：实现插件系统和渲染集成

1. PluginManager 插件管理器
2. PluginLoader 插件加载器
3. PluginDispatcher 插件调度器
4. PluginSandbox 插件沙箱
5. 渲染引擎集成

### 阶段四：UI 组件与交互（5天）

**目标**：实现用户界面和交互功能

1. 主界面布局
2. 导航栏组件
3. 侧边栏组件
4. 工具栏组件
5. 快捷键系统
6. 主题切换

### 阶段五：测试与优化（5天）

**目标**：完成测试和性能优化

1. 单元测试
2. 集成测试
3. E2E 测试
4. 性能优化
5. 文档完善

---

## 四、开发策略

### 4.1 前期策略（阶段一至三）

- **顺序开发**：确保基础架构稳定后再进行功能开发
- **严格测试**：每个模块完成后进行单元测试
- **代码审查**：重要模块需要详细审查

### 4.2 后期策略（阶段四至五）

- **并行开发**：UI 组件可以并行开发
- **持续集成**：频繁集成和测试
- **性能优先**：关注性能指标

### 4.3 质量保证

- 测试覆盖率要求：核心模块 ≥ 90%，整体 ≥ 80%
- 代码规范：严格遵循 ESLint + Prettier 规范
- 类型安全：100% TypeScript，无 any 类型

---

## 五、技术栈

### 5.1 核心技术

| 技术 | 版本 | 说明 |
|------|------|------|
| Vue 3 | ^3.4.0 | 前端框架 |
| TypeScript | ^5.3.0 | 类型系统 |
| Vite | ^5.0.0 | 构建工具 |
| Pinia | ^2.1.0 | 状态管理 |
| Electron | ^28.0.0 | 桌面框架 |

### 5.2 测试工具

| 工具 | 版本 | 说明 |
|------|------|------|
| Vitest | ^1.0.0 | 单元测试 |
| Playwright | ^1.40.0 | E2E 测试 |
| Vue Test Utils | ^2.4.0 | Vue 组件测试 |

---

## 六、里程碑

| 阶段 | 里程碑 | 完成标准 |
|------|--------|---------|
| Phase 1 | 项目骨架完成 | 项目可运行，SDK 连接正常 |
| Phase 2 | 核心模块完成 | 可打开和显示卡片 |
| Phase 3 | 插件系统完成 | 插件可正常加载和调度 |
| Phase 4 | UI 完成 | 完整的用户界面 |
| Phase 5 | 发布就绪 | 测试通过，性能达标 |

---

## 七、性能目标

| 指标 | 目标值 |
|------|--------|
| 首次启动时间 | < 2秒 |
| 卡片打开时间 | < 500ms |
| 内存占用（空闲） | < 200MB |
| 应用包大小 | < 100MB |

---

## 八、目录结构

```
Chips-Viewer/
├── src/
│   ├── main/                     # Electron 主进程
│   │   ├── index.ts              # 主进程入口
│   │   ├── window/               # 窗口管理
│   │   ├── menu/                 # 菜单管理
│   │   ├── ipc/                  # IPC 通信
│   │   └── updater/              # 自动更新
│   │
│   ├── renderer/                 # 渲染进程/Web 前端
│   │   ├── App.vue               # 根组件
│   │   ├── main.ts               # 渲染进程入口
│   │   ├── components/           # UI 组件
│   │   ├── pages/                # 页面组件
│   │   ├── core/                 # 核心逻辑
│   │   ├── services/             # 服务层
│   │   ├── store/                # 状态管理
│   │   ├── composables/          # 组合式函数
│   │   ├── utils/                # 工具函数
│   │   └── assets/               # 静态资源
│   │
│   ├── common/                   # 共享代码
│   │   ├── types/                # 类型定义
│   │   ├── constants/            # 常量定义
│   │   ├── interfaces/           # 接口定义
│   │   └── utils/                # 共享工具
│   │
│   └── plugins/                  # 内置插件
│       ├── video-viewer/
│       ├── image-viewer/
│       ├── code-viewer/
│       └── pdf-viewer/
│
├── tests/                        # 测试目录
│   ├── unit/                     # 单元测试
│   ├── integration/              # 集成测试
│   └── e2e/                      # E2E 测试
│
├── 开发计划/                      # 开发计划文档
│   ├── Phase1-项目初始化与基础架构/
│   ├── Phase2-核心模块开发/
│   ├── Phase3-插件系统与渲染集成/
│   ├── Phase4-UI组件与交互/
│   └── Phase5-测试与优化/
│
├── 技术文档/                      # 技术文档
├── 需求文档/                      # 需求文档
├── package.json
├── tsconfig.json
├── vite.config.ts
├── electron.vite.config.ts
└── vitest.config.ts
```

---

**下一步**：按照各阶段任务清单，顺序完成开发工作。
