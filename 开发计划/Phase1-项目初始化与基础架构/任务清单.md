# Phase 1: 项目初始化与基础架构

**阶段目标**：搭建项目骨架，配置开发环境，实现基础架构  
**预计工期**：5天  
**开发模式**：顺序开发（确保基础稳定）

---

## 任务清单

### 任务 1.1：项目初始化（0.5天）

#### 1.1.1 创建项目目录结构

**描述**：创建 Chips-Viewer 的完整目录结构

**详细步骤**：
1. 创建 `src/main/` 目录（Electron 主进程）
2. 创建 `src/renderer/` 目录（渲染进程）
3. 创建 `src/common/` 目录（共享代码）
4. 创建 `src/plugins/` 目录（内置插件）
5. 创建 `tests/` 目录（测试文件）

**目录结构**：
```
src/
├── main/
│   ├── index.ts
│   ├── window/
│   ├── menu/
│   ├── ipc/
│   └── updater/
├── renderer/
│   ├── App.vue
│   ├── main.ts
│   ├── components/
│   ├── pages/
│   ├── core/
│   ├── services/
│   ├── store/
│   ├── composables/
│   ├── utils/
│   └── assets/
├── common/
│   ├── types/
│   ├── constants/
│   ├── interfaces/
│   └── utils/
└── plugins/
```

**验收标准**：
- [ ] 所有目录已创建
- [ ] 目录结构符合规范

---

#### 1.1.2 初始化 Git 子仓库

**描述**：在 Chips-Viewer 目录下初始化 Git 子仓库

**详细步骤**：
1. 在 Chips-Viewer 目录下执行 `git init`
2. 创建 `.gitignore` 文件
3. 创建初始提交

**.gitignore 内容**：
```gitignore
# Dependencies
node_modules/
.pnpm-store/

# Build output
dist/
dist-electron/
out/

# IDE
.vscode/
.idea/
*.swp
*.swo
.DS_Store

# Logs
*.log
npm-debug.log*
pnpm-debug.log*

# Test coverage
coverage/

# Environment
.env
.env.local
.env.*.local

# Temporary
*.tmp
*.temp
.cache/
```

**验收标准**：
- [ ] Git 仓库已初始化
- [ ] .gitignore 文件已创建
- [ ] 初始提交已完成

---

#### 1.1.3 初始化 package.json

**描述**：创建 package.json 配置文件

**package.json 核心配置**：
```json
{
  "name": "@chips/viewer",
  "version": "1.0.0",
  "description": "薯片卡片查看器 - Chips 生态的轻量级查看应用",
  "main": "dist-electron/main/index.js",
  "type": "module",
  "scripts": {
    "dev": "electron-vite dev",
    "build": "electron-vite build",
    "preview": "electron-vite preview",
    "test": "vitest",
    "test:coverage": "vitest --coverage",
    "test:e2e": "playwright test",
    "lint": "eslint src --ext .ts,.vue",
    "lint:fix": "eslint src --ext .ts,.vue --fix",
    "type-check": "vue-tsc --noEmit",
    "format": "prettier --write src"
  },
  "dependencies": {
    "@chips/core": "^1.0.0",
    "@chips/foundation": "^1.0.0",
    "@chips/sdk": "^1.0.0",
    "@chips/components": "^0.1.0",
    "vue": "^3.4.0",
    "vue-router": "^4.2.0",
    "pinia": "^2.1.0"
  },
  "devDependencies": {
    "electron": "^28.0.0",
    "electron-vite": "^2.0.0",
    "vite": "^5.0.0",
    "typescript": "^5.3.0",
    "vue-tsc": "^1.8.0",
    "@vitejs/plugin-vue": "^4.5.0",
    "vitest": "^1.0.0",
    "@vitest/coverage-v8": "^1.0.0",
    "@vue/test-utils": "^2.4.0",
    "playwright": "^1.40.0",
    "eslint": "^8.56.0",
    "eslint-plugin-vue": "^9.19.0",
    "@typescript-eslint/eslint-plugin": "^6.18.0",
    "@typescript-eslint/parser": "^6.18.0",
    "prettier": "^3.1.0"
  },
  "engines": {
    "node": ">=20.0.0"
  }
}
```

**验收标准**：
- [ ] package.json 已创建
- [ ] 依赖项配置正确
- [ ] scripts 命令配置完整

---

### 任务 1.2：配置文件创建（0.5天）

#### 1.2.1 TypeScript 配置

**描述**：创建 TypeScript 配置文件

**tsconfig.json**：
```json
{
  "compilerOptions": {
    "target": "ESNext",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "strict": true,
    "jsx": "preserve",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "esModuleInterop": true,
    "lib": ["ESNext", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "noEmit": true,
    "paths": {
      "@/*": ["./src/*"],
      "@common/*": ["./src/common/*"],
      "@renderer/*": ["./src/renderer/*"],
      "@main/*": ["./src/main/*"]
    },
    "types": ["node", "electron"]
  },
  "include": ["src/**/*.ts", "src/**/*.vue", "src/**/*.d.ts"],
  "exclude": ["node_modules", "dist", "dist-electron"]
}
```

**tsconfig.node.json**（用于 Node.js 环境）：
```json
{
  "extends": "./tsconfig.json",
  "compilerOptions": {
    "module": "ESNext",
    "moduleResolution": "bundler",
    "types": ["node"]
  },
  "include": ["src/main/**/*.ts", "electron.vite.config.ts", "vite.config.ts"]
}
```

**验收标准**：
- [ ] tsconfig.json 已创建
- [ ] tsconfig.node.json 已创建
- [ ] 类型检查通过

---

#### 1.2.2 Vite 配置

**描述**：创建 Vite 和 Electron-Vite 配置文件

**vite.config.ts**（Web 模式）：
```typescript
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
      '@common': resolve(__dirname, 'src/common'),
      '@renderer': resolve(__dirname, 'src/renderer'),
    },
  },
  build: {
    target: 'esnext',
    minify: 'esbuild',
    sourcemap: true,
  },
});
```

**electron.vite.config.ts**（Electron 模式）：
```typescript
import { defineConfig, externalizeDepsPlugin } from 'electron-vite';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

export default defineConfig({
  main: {
    plugins: [externalizeDepsPlugin()],
    build: {
      rollupOptions: {
        input: {
          index: resolve(__dirname, 'src/main/index.ts'),
        },
      },
    },
  },
  preload: {
    plugins: [externalizeDepsPlugin()],
  },
  renderer: {
    plugins: [vue()],
    resolve: {
      alias: {
        '@': resolve(__dirname, 'src'),
        '@common': resolve(__dirname, 'src/common'),
        '@renderer': resolve(__dirname, 'src/renderer'),
      },
    },
  },
});
```

**验收标准**：
- [ ] vite.config.ts 已创建
- [ ] electron.vite.config.ts 已创建
- [ ] 构建配置正确

---

#### 1.2.3 ESLint 和 Prettier 配置

**描述**：创建代码规范配置文件

**.eslintrc.cjs**：
```javascript
module.exports = {
  root: true,
  env: {
    browser: true,
    node: true,
    es2022: true,
  },
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:vue/vue3-recommended',
  ],
  parser: 'vue-eslint-parser',
  parserOptions: {
    parser: '@typescript-eslint/parser',
    ecmaVersion: 'latest',
    sourceType: 'module',
  },
  plugins: ['@typescript-eslint', 'vue'],
  rules: {
    '@typescript-eslint/no-explicit-any': 'error',
    '@typescript-eslint/explicit-function-return-type': 'warn',
    'vue/multi-word-component-names': 'off',
    'no-console': 'warn',
    'no-debugger': 'error',
  },
};
```

**.prettierrc**：
```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100,
  "bracketSpacing": true,
  "arrowParens": "avoid",
  "endOfLine": "lf"
}
```

**验收标准**：
- [ ] .eslintrc.cjs 已创建
- [ ] .prettierrc 已创建
- [ ] Lint 检查通过

---

#### 1.2.4 Vitest 配置

**描述**：创建测试框架配置文件

**vitest.config.ts**：
```typescript
import { defineConfig } from 'vitest/config';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

export default defineConfig({
  plugins: [vue()],
  test: {
    globals: true,
    environment: 'jsdom',
    coverage: {
      provider: 'v8',
      reporter: ['text', 'json', 'html'],
      exclude: ['node_modules/', 'tests/', 'dist/'],
      thresholds: {
        global: {
          branches: 80,
          functions: 80,
          lines: 80,
          statements: 80,
        },
      },
    },
    include: ['tests/**/*.{test,spec}.ts'],
    exclude: ['node_modules', 'dist'],
  },
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
      '@common': resolve(__dirname, 'src/common'),
      '@renderer': resolve(__dirname, 'src/renderer'),
    },
  },
});
```

**验收标准**：
- [ ] vitest.config.ts 已创建
- [ ] 测试环境配置正确
- [ ] 覆盖率阈值配置正确

---

### 任务 1.3：核心类型定义（1天）

#### 1.3.1 基础类型定义

**描述**：创建项目使用的基础类型定义

**文件**：`src/common/types/base.ts`

```typescript
/**
 * 基础类型定义
 */

// 10位62进制 ID 类型
export type ChipsId = string & { readonly __brand: 'ChipsId' };
export type CardId = ChipsId & { readonly __cardBrand: 'CardId' };
export type BoxId = ChipsId & { readonly __boxBrand: 'BoxId' };

// 时间戳类型（ISO 8601）
export type Timestamp = string;

// 协议版本
export type ProtocolVersion = `${number}.${number}.${number}`;

// 状态类型
export type Status = 'success' | 'error' | 'partial';

// 日志级别
export type LogLevel = 'debug' | 'info' | 'warn' | 'error';

// 文件类型
export type FileType = 'card' | 'box' | 'resource' | 'unknown';

// 位置类型
export type LocationType = 'internal' | 'external';

// 渲染模式
export type RenderMode = 'full' | 'preview' | 'thumbnail';

// 平台类型
export type Platform = 'electron' | 'web' | 'mobile';

// 主题类型
export type ThemeType = 'light' | 'dark' | 'system';
```

**验收标准**：
- [ ] 基础类型文件已创建
- [ ] 类型定义符合规范
- [ ] 类型注释完整

---

#### 1.3.2 卡片和箱子类型定义

**描述**：创建卡片和箱子相关的类型定义

**文件**：`src/common/types/card.ts`

```typescript
/**
 * 卡片相关类型定义
 */
import type { CardId, ChipsId, Timestamp, ProtocolVersion, RenderMode } from './base';

// 标签类型
export type Tag = string | [string, ...string[]];

// 卡片元数据
export interface CardMetadata {
  chip_standards_version: ProtocolVersion;
  card_id: CardId;
  name: string;
  created_at: Timestamp;
  modified_at: Timestamp;
  theme?: string;
  tags?: Tag[];
  description?: string;
  author?: string;
  visibility?: 'public' | 'private' | 'unlisted';
  downloadable?: boolean;
  remixable?: boolean;
  license?: string;
  [key: string]: unknown;
}

// 基础卡片信息
export interface BaseCardInfo {
  id: ChipsId;
  type: string;
}

// 卡片资源信息
export interface CardResource {
  path: string;
  size: number;
  type: string;
  checksum?: string;
  duration?: number;
  width?: number;
  height?: number;
}

// 卡片清单
export interface CardManifest {
  card_count: number;
  resource_count: number;
  resources: CardResource[];
}

// 卡片结构
export interface CardStructure {
  structure: BaseCardInfo[];
  manifest: CardManifest;
}

// 卡片完整数据
export interface Card {
  id: CardId;
  metadata: CardMetadata;
  structure: CardStructure;
  resources?: Map<string, Blob | ArrayBuffer>;
}

// 卡片渲染选项
export interface CardRenderOptions {
  cardId: CardId;
  containerId: string;
  themeId?: string;
  mode?: RenderMode;
  interactive?: boolean;
  autoHeight?: boolean;
}

// 卡片渲染结果
export interface CardRenderResult {
  success: boolean;
  frame?: HTMLIFrameElement;
  metadata?: CardMetadata;
  error?: string;
  duration?: number;
}

// 卡片查询选项
export interface CardQueryOptions {
  tags?: Tag[];
  author?: string;
  dateRange?: {
    start: Timestamp;
    end: Timestamp;
  };
  limit?: number;
  offset?: number;
}
```

**文件**：`src/common/types/box.ts`

```typescript
/**
 * 箱子相关类型定义
 */
import type { BoxId, ChipsId, Timestamp, ProtocolVersion, Tag, LocationType } from './base';
import type { CardMetadata } from './card';

// 箱子元数据
export interface BoxMetadata {
  chip_standards_version: ProtocolVersion;
  box_id: BoxId;
  name: string;
  created_at: Timestamp;
  modified_at: Timestamp;
  layout: string;
  theme?: string;
  tags?: Tag[];
  description?: string;
  [key: string]: unknown;
}

// 箱子卡片条目
export interface BoxCardEntry {
  id: ChipsId;
  location: LocationType;
  path: string;
  auth_profile?: string;
  metadata_cache?: Partial<CardMetadata>;
}

// 箱子结构
export interface BoxStructure {
  cards: BoxCardEntry[];
  total_count: number;
}

// 布局配置
export interface LayoutConfig {
  layout_type: string;
  [key: string]: unknown;
}

// 箱子内容配置
export interface BoxContent {
  active_layout: string;
  layout_configs: Record<string, LayoutConfig>;
}

// 箱子完整数据
export interface Box {
  id: BoxId;
  metadata: BoxMetadata;
  structure: BoxStructure;
  content: BoxContent;
}

// 箱子渲染选项
export interface BoxRenderOptions {
  boxId: BoxId;
  containerId: string;
  themeId?: string;
  layoutConfig?: Partial<LayoutConfig>;
}

// 箱子渲染结果
export interface BoxRenderResult {
  success: boolean;
  frame?: HTMLIFrameElement;
  metadata?: BoxMetadata;
  error?: string;
  duration?: number;
}
```

**验收标准**：
- [ ] card.ts 类型文件已创建
- [ ] box.ts 类型文件已创建
- [ ] 类型定义与生态规范一致

---

#### 1.3.3 插件类型定义

**描述**：创建插件系统相关的类型定义

**文件**：`src/common/types/plugin.ts`

```typescript
/**
 * 插件系统类型定义
 */

// 插件状态
export type PluginState = 'installed' | 'enabled' | 'disabled' | 'loading' | 'error';

// 插件类型
export type PluginType = 'viewer-tool' | 'layout' | 'theme' | 'utility';

// 插件元数据
export interface PluginMetadata {
  id: string;
  name: string;
  version: string;
  type: PluginType;
  description?: string;
  author?: {
    name: string;
    email?: string;
    url?: string;
  };
  license?: string;
  homepage?: string;
  repository?: string;
  icon?: string;
  supportedTypes?: string[];
  supportedExtensions?: string[];
  minViewerVersion?: string;
}

// 插件清单
export interface PluginManifest extends PluginMetadata {
  main: string;
  style?: string;
  permissions?: string[];
  settings?: PluginSetting[];
  dependencies?: Record<string, string>;
}

// 插件设置项
export interface PluginSetting {
  key: string;
  type: 'boolean' | 'number' | 'string' | 'select' | 'color';
  default: unknown;
  label: string;
  description?: string;
  options?: Array<{ value: unknown; label: string }>;
  min?: number;
  max?: number;
}

// 插件实例
export interface PluginInstance {
  id: string;
  metadata: PluginMetadata;
  state: PluginState;
  config: Record<string, unknown>;
  error?: string;
}

// 插件上下文
export interface PluginContext {
  pluginId: string;
  sdkVersion: string;
  config: Record<string, unknown>;
  
  // API 访问
  api: {
    file: unknown;
    storage: unknown;
    theme: unknown;
    i18n: unknown;
  };
  
  // 日志
  log: (message: string, data?: unknown) => void;
  
  // 注册
  registerCommand: (name: string, handler: CommandHandler) => void;
  registerRenderer: (type: string, renderer: RendererDefinition) => void;
  
  // 事件
  emit: (event: string, data: unknown) => void;
  on: (event: string, handler: (data: unknown) => void) => void;
  
  // 设置
  getSettings: () => Record<string, unknown>;
  updateSettings: (settings: Partial<Record<string, unknown>>) => void;
}

// 命令处理器
export type CommandHandler = (...args: unknown[]) => unknown | Promise<unknown>;

// 渲染器定义
export interface RendererDefinition {
  cardTypes: string[];
  render: (context: RenderContext) => Promise<RenderResult>;
  update?: (context: RenderContext) => Promise<void>;
  dispose?: () => void;
}

// 渲染上下文
export interface RenderContext {
  card: unknown;
  container: HTMLElement;
  theme: string;
  options: Record<string, unknown>;
}

// 渲染结果
export interface RenderResult {
  success: boolean;
  html?: string;
  css?: string;
  error?: string;
}

// 查看工具插件接口
export interface IViewerToolPlugin {
  readonly manifest: PluginManifest;
  
  // 生命周期
  init(context: PluginContext): Promise<void>;
  destroy(): Promise<void>;
  
  // 文件支持检查
  canHandle(file: FileInfo): boolean;
  
  // 渲染
  render(file: FileInfo, container: HTMLElement, options?: RenderOptions): Promise<RenderResult>;
  dispose(): void;
}

// 文件信息
export interface FileInfo {
  path: string;
  name: string;
  extension: string;
  mimeType: string;
  size: number;
  lastModified: Date;
}

// 渲染选项
export interface RenderOptions {
  theme?: string;
  interactive?: boolean;
  width?: number;
  height?: number;
  [key: string]: unknown;
}

// 插件注册信息
export interface PluginRegistration {
  id: string;
  metadata: PluginMetadata;
  activate: (context: PluginContext) => void | Promise<void>;
  deactivate?: () => void | Promise<void>;
}

// 插件查询选项
export interface PluginQueryOptions {
  type?: PluginType;
  state?: PluginState;
  supportedType?: string;
}
```

**验收标准**：
- [ ] plugin.ts 类型文件已创建
- [ ] 插件接口定义完整
- [ ] 符合插件开发规范

---

#### 1.3.4 Viewer 特有类型定义

**描述**：创建 Viewer 应用特有的类型定义

**文件**：`src/common/types/viewer.ts`

```typescript
/**
 * Viewer 应用类型定义
 */
import type { Card, CardRenderOptions, CardRenderResult } from './card';
import type { Box, BoxRenderOptions, BoxRenderResult } from './box';
import type { ThemeType, Platform } from './base';

// Viewer 状态
export type ViewerState = 'idle' | 'initializing' | 'ready' | 'loading' | 'error' | 'destroyed';

// Viewer 配置
export interface ViewerConfig {
  // 基础配置
  platform: Platform;
  language: string;
  theme: ThemeType;
  
  // 功能配置
  plugins: {
    autoLoad: boolean;
    enableBuiltin: boolean;
    customPaths?: string[];
  };
  
  // 渲染配置
  rendering: {
    defaultMode: 'full' | 'preview';
    lazyLoad: boolean;
    cacheSize: number;
    preloadCount: number;
  };
  
  // 导航配置
  navigation: {
    enableHistory: boolean;
    maxHistory: number;
    enableShortcuts: boolean;
  };
  
  // 窗口配置
  window?: {
    width: number;
    height: number;
    minWidth: number;
    minHeight: number;
    maximizable: boolean;
    fullscreenable: boolean;
  };
}

// 导航目标
export interface NavigationTarget {
  type: 'card' | 'box' | 'url';
  path: string;
  options?: Record<string, unknown>;
}

// 导航历史条目
export interface NavigationHistoryEntry {
  id: string;
  target: NavigationTarget;
  title: string;
  timestamp: Date;
  scrollPosition?: { x: number; y: number };
}

// 当前内容
export interface CurrentContent {
  type: 'card' | 'box' | 'none';
  data: Card | Box | null;
  path: string | null;
  renderResult: CardRenderResult | BoxRenderResult | null;
}

// 视图选项
export interface ViewOptions {
  zoom: number;
  fitMode: 'auto' | 'width' | 'height' | 'page';
  showSidebar: boolean;
  showToolbar: boolean;
  showStatusBar: boolean;
}

// Viewer 事件类型
export type ViewerEventType =
  | 'content:open'
  | 'content:close'
  | 'content:render'
  | 'content:error'
  | 'navigation:change'
  | 'navigation:back'
  | 'navigation:forward'
  | 'plugin:load'
  | 'plugin:unload'
  | 'plugin:error'
  | 'theme:change'
  | 'zoom:change'
  | 'state:change';

// Viewer 事件数据
export interface ViewerEvent<T = unknown> {
  type: ViewerEventType;
  data: T;
  timestamp: Date;
}

// 快捷键绑定
export interface ShortcutBinding {
  key: string;
  modifiers?: ('ctrl' | 'alt' | 'shift' | 'meta')[];
  action: string;
  description?: string;
}

// 工具栏项目
export interface ToolbarItem {
  id: string;
  type: 'button' | 'toggle' | 'dropdown' | 'separator';
  icon?: string;
  label?: string;
  tooltip?: string;
  action?: string;
  disabled?: boolean;
  active?: boolean;
  items?: ToolbarItem[];
}

// 侧边栏面板
export interface SidebarPanel {
  id: string;
  title: string;
  icon?: string;
  component: string;
  position: 'left' | 'right';
  width?: number;
  minWidth?: number;
  maxWidth?: number;
  collapsible?: boolean;
  defaultCollapsed?: boolean;
}

// 状态栏项目
export interface StatusBarItem {
  id: string;
  position: 'left' | 'center' | 'right';
  content: string;
  tooltip?: string;
  clickable?: boolean;
  action?: string;
}
```

**验收标准**：
- [ ] viewer.ts 类型文件已创建
- [ ] Viewer 专用类型定义完整
- [ ] 类型覆盖所有功能模块

---

#### 1.3.5 类型导出索引

**描述**：创建类型导出索引文件

**文件**：`src/common/types/index.ts`

```typescript
/**
 * 类型定义导出索引
 */

// 基础类型
export * from './base';

// 卡片类型
export * from './card';

// 箱子类型
export * from './box';

// 插件类型
export * from './plugin';

// Viewer 类型
export * from './viewer';
```

**验收标准**：
- [ ] index.ts 导出文件已创建
- [ ] 所有类型正确导出
- [ ] 无循环依赖

---

### 任务 1.4：常量和接口定义（0.5天）

#### 1.4.1 常量定义

**描述**：创建项目常量定义

**文件**：`src/common/constants/index.ts`

```typescript
/**
 * 常量定义
 */

// 版本信息
export const VERSION = '1.0.0';
export const PROTOCOL_VERSION = '1.0.0';
export const MIN_SDK_VERSION = '1.0.0';

// 默认配置
export const DEFAULT_CONFIG = {
  language: 'zh-CN',
  theme: 'system' as const,
  plugins: {
    autoLoad: true,
    enableBuiltin: true,
  },
  rendering: {
    defaultMode: 'full' as const,
    lazyLoad: true,
    cacheSize: 50,
    preloadCount: 3,
  },
  navigation: {
    enableHistory: true,
    maxHistory: 100,
    enableShortcuts: true,
  },
} as const;

// 事件名称
export const EVENTS = {
  CONTENT_OPEN: 'content:open',
  CONTENT_CLOSE: 'content:close',
  CONTENT_RENDER: 'content:render',
  CONTENT_ERROR: 'content:error',
  NAVIGATION_CHANGE: 'navigation:change',
  NAVIGATION_BACK: 'navigation:back',
  NAVIGATION_FORWARD: 'navigation:forward',
  PLUGIN_LOAD: 'plugin:load',
  PLUGIN_UNLOAD: 'plugin:unload',
  PLUGIN_ERROR: 'plugin:error',
  THEME_CHANGE: 'theme:change',
  ZOOM_CHANGE: 'zoom:change',
  STATE_CHANGE: 'state:change',
} as const;

// IPC 通道名称
export const IPC_CHANNELS = {
  // 窗口操作
  WINDOW_MINIMIZE: 'window:minimize',
  WINDOW_MAXIMIZE: 'window:maximize',
  WINDOW_CLOSE: 'window:close',
  WINDOW_FULLSCREEN: 'window:fullscreen',
  
  // 文件操作
  FILE_OPEN: 'file:open',
  FILE_OPEN_DIALOG: 'file:open-dialog',
  FILE_RECENT: 'file:recent',
  
  // 菜单操作
  MENU_ACTION: 'menu:action',
  
  // 系统
  APP_READY: 'app:ready',
  APP_QUIT: 'app:quit',
} as const;

// 快捷键
export const DEFAULT_SHORTCUTS = {
  'open-file': { key: 'o', modifiers: ['ctrl'] },
  'close-file': { key: 'w', modifiers: ['ctrl'] },
  'zoom-in': { key: '+', modifiers: ['ctrl'] },
  'zoom-out': { key: '-', modifiers: ['ctrl'] },
  'zoom-reset': { key: '0', modifiers: ['ctrl'] },
  'fullscreen': { key: 'f11' },
  'navigate-back': { key: 'ArrowLeft', modifiers: ['alt'] },
  'navigate-forward': { key: 'ArrowRight', modifiers: ['alt'] },
  'toggle-sidebar': { key: 'b', modifiers: ['ctrl'] },
  'toggle-theme': { key: 't', modifiers: ['ctrl', 'shift'] },
} as const;

// 文件扩展名
export const FILE_EXTENSIONS = {
  CARD: '.card',
  BOX: '.box',
} as const;

// MIME 类型
export const MIME_TYPES = {
  CARD: 'application/x-card',
  BOX: 'application/x-box',
} as const;

// 缓存键
export const CACHE_KEYS = {
  RECENT_FILES: 'viewer:recent-files',
  USER_CONFIG: 'viewer:user-config',
  PLUGIN_STATE: 'viewer:plugin-state',
  NAVIGATION_HISTORY: 'viewer:navigation-history',
} as const;

// 性能阈值
export const PERFORMANCE_THRESHOLDS = {
  STARTUP_TIME: 2000,      // 启动时间 < 2秒
  OPEN_TIME: 500,          // 打开时间 < 500ms
  RENDER_TIME: 200,        // 渲染时间 < 200ms
  MEMORY_LIMIT: 200,       // 内存限制 200MB
} as const;
```

**验收标准**：
- [ ] 常量文件已创建
- [ ] 常量命名规范
- [ ] 常量值正确

---

#### 1.4.2 接口定义

**描述**：创建核心接口定义

**文件**：`src/common/interfaces/index.ts`

```typescript
/**
 * 核心接口定义
 */
import type { Card, CardRenderOptions, CardRenderResult } from '../types/card';
import type { Box, BoxRenderOptions, BoxRenderResult } from '../types/box';
import type { PluginInstance, PluginMetadata, PluginRegistration, PluginQueryOptions } from '../types/plugin';
import type { ViewerConfig, NavigationTarget, NavigationHistoryEntry, CurrentContent, ViewerState, ViewerEvent } from '../types/viewer';

/**
 * Viewer 应用接口
 */
export interface IViewerApp {
  // 状态
  readonly state: ViewerState;
  readonly isReady: boolean;
  readonly currentContent: CurrentContent;
  
  // 生命周期
  initialize(): Promise<void>;
  destroy(): Promise<void>;
  
  // 内容操作
  openCard(path: string, options?: Partial<CardRenderOptions>): Promise<void>;
  openBox(path: string, options?: Partial<BoxRenderOptions>): Promise<void>;
  closeContent(): void;
  
  // 导航
  navigate(target: NavigationTarget): Promise<void>;
  goBack(): void;
  goForward(): void;
  canGoBack(): boolean;
  canGoForward(): boolean;
  
  // 事件
  on<T>(event: string, handler: (data: T) => void): string;
  off(event: string, handlerId?: string): void;
  emit(event: string, data?: unknown): void;
}

/**
 * 卡片管理器接口
 */
export interface ICardManager {
  openCard(path: string, container: HTMLElement, options?: Partial<CardRenderOptions>): Promise<CardRenderResult>;
  closeCard(): void;
  getCurrentCard(): Card | null;
  getCardMetadata(path: string): Promise<Card['metadata']>;
  validateCard(path: string): Promise<boolean>;
}

/**
 * 箱子管理器接口
 */
export interface IBoxManager {
  openBox(path: string, container: HTMLElement, options?: Partial<BoxRenderOptions>): Promise<BoxRenderResult>;
  closeBox(): void;
  getCurrentBox(): Box | null;
  getBoxMetadata(path: string): Promise<Box['metadata']>;
  validateBox(path: string): Promise<boolean>;
}

/**
 * 导航控制器接口
 */
export interface INavigationController {
  navigate(target: NavigationTarget): Promise<void>;
  goBack(): void;
  goForward(): void;
  canGoBack(): boolean;
  canGoForward(): boolean;
  getHistory(): NavigationHistoryEntry[];
  clearHistory(): void;
  getCurrentEntry(): NavigationHistoryEntry | null;
}

/**
 * 插件管理器接口
 */
export interface IPluginManager {
  // 注册
  register(registration: PluginRegistration): void;
  unregister(id: string): Promise<void>;
  
  // 启用/禁用
  enable(id: string): Promise<void>;
  disable(id: string): Promise<void>;
  
  // 查询
  get(id: string): PluginInstance | undefined;
  getMetadata(id: string): PluginMetadata | undefined;
  list(options?: PluginQueryOptions): PluginInstance[];
  isEnabled(id: string): boolean;
  
  // 调度
  getPluginForFile(path: string): PluginInstance | undefined;
  getPluginsForType(mimeType: string): PluginInstance[];
}

/**
 * 主题管理器接口
 */
export interface IThemeManager {
  getCurrentTheme(): string;
  setTheme(themeId: string): void;
  listThemes(): Array<{ id: string; name: string; type: 'light' | 'dark' }>;
  applyTheme(themeId: string, element?: HTMLElement): void;
  getSystemTheme(): 'light' | 'dark';
  watchSystemTheme(callback: (theme: 'light' | 'dark') => void): void;
}

/**
 * 配置管理器接口
 */
export interface IConfigManager {
  get<T>(key: string, defaultValue?: T): T;
  set(key: string, value: unknown): void;
  getAll(): ViewerConfig;
  reset(): void;
  save(): Promise<void>;
  load(): Promise<void>;
  onChange(key: string, handler: (newValue: unknown, oldValue: unknown) => void): void;
}

/**
 * 事件总线接口
 */
export interface IEventBus {
  on<T>(event: string, handler: (data: T) => void): string;
  once<T>(event: string, handler: (data: T) => void): string;
  off(event: string, handlerId?: string): void;
  emit(event: string, data?: unknown): void;
  clear(): void;
}

/**
 * 日志服务接口
 */
export interface ILogger {
  debug(message: string, data?: Record<string, unknown>): void;
  info(message: string, data?: Record<string, unknown>): void;
  warn(message: string, data?: Record<string, unknown>): void;
  error(message: string, error?: Error, data?: Record<string, unknown>): void;
  setLevel(level: 'debug' | 'info' | 'warn' | 'error'): void;
  createChild(module: string): ILogger;
}
```

**验收标准**：
- [ ] 接口文件已创建
- [ ] 接口定义完整
- [ ] 接口与类型文件一致

---

### 任务 1.5：基础服务层实现（1.5天）

#### 1.5.1 事件总线实现

**描述**：实现事件总线服务

**文件**：`src/renderer/services/EventBus.ts`

```typescript
/**
 * 事件总线服务
 */
import type { IEventBus } from '@common/interfaces';

type EventHandler<T = unknown> = (data: T) => void;

interface EventSubscription {
  id: string;
  handler: EventHandler;
  once: boolean;
}

export class EventBus implements IEventBus {
  private subscriptions: Map<string, EventSubscription[]> = new Map();
  private idCounter = 0;

  /**
   * 订阅事件
   */
  on<T>(event: string, handler: EventHandler<T>): string {
    return this.subscribe(event, handler as EventHandler, false);
  }

  /**
   * 订阅事件（只触发一次）
   */
  once<T>(event: string, handler: EventHandler<T>): string {
    return this.subscribe(event, handler as EventHandler, true);
  }

  /**
   * 取消订阅
   */
  off(event: string, handlerId?: string): void {
    if (!handlerId) {
      this.subscriptions.delete(event);
      return;
    }

    const subs = this.subscriptions.get(event);
    if (subs) {
      const filtered = subs.filter(sub => sub.id !== handlerId);
      if (filtered.length > 0) {
        this.subscriptions.set(event, filtered);
      } else {
        this.subscriptions.delete(event);
      }
    }
  }

  /**
   * 发布事件
   */
  emit(event: string, data?: unknown): void {
    const subs = this.subscriptions.get(event);
    if (!subs) return;

    const toRemove: string[] = [];
    
    for (const sub of subs) {
      try {
        sub.handler(data);
        if (sub.once) {
          toRemove.push(sub.id);
        }
      } catch (error) {
        console.error(`Event handler error for event "${event}":`, error);
      }
    }

    // 移除一次性订阅
    for (const id of toRemove) {
      this.off(event, id);
    }
  }

  /**
   * 清除所有订阅
   */
  clear(): void {
    this.subscriptions.clear();
  }

  /**
   * 等待事件
   */
  waitFor<T>(event: string, timeout?: number): Promise<T> {
    return new Promise((resolve, reject) => {
      const timeoutId = timeout
        ? setTimeout(() => {
            this.off(event, handlerId);
            reject(new Error(`Timeout waiting for event "${event}"`));
          }, timeout)
        : null;

      const handlerId = this.once<T>(event, data => {
        if (timeoutId) clearTimeout(timeoutId);
        resolve(data);
      });
    });
  }

  /**
   * 获取事件订阅数量
   */
  listenerCount(event: string): number {
    return this.subscriptions.get(event)?.length ?? 0;
  }

  private subscribe(event: string, handler: EventHandler, once: boolean): string {
    const id = `${event}-${++this.idCounter}`;
    const subscription: EventSubscription = { id, handler, once };

    const subs = this.subscriptions.get(event) ?? [];
    subs.push(subscription);
    this.subscriptions.set(event, subs);

    return id;
  }
}

// 单例导出
export const eventBus = new EventBus();
```

**验收标准**：
- [ ] EventBus 类实现完整
- [ ] 支持 on/once/off/emit
- [ ] 支持 waitFor 异步等待
- [ ] 单元测试通过

---

#### 1.5.2 日志服务实现

**描述**：实现日志服务

**文件**：`src/renderer/services/Logger.ts`

```typescript
/**
 * 日志服务
 */
import type { ILogger } from '@common/interfaces';
import type { LogLevel } from '@common/types';

interface LogEntry {
  level: LogLevel;
  message: string;
  module: string;
  timestamp: Date;
  data?: Record<string, unknown>;
  error?: Error;
}

type LogTransport = (entry: LogEntry) => void;

const LOG_LEVELS: Record<LogLevel, number> = {
  debug: 0,
  info: 1,
  warn: 2,
  error: 3,
};

export class Logger implements ILogger {
  private level: LogLevel = 'info';
  private module: string;
  private transports: LogTransport[] = [];

  constructor(module = 'Viewer') {
    this.module = module;
    
    // 默认控制台输出
    this.addTransport(this.consoleTransport.bind(this));
  }

  debug(message: string, data?: Record<string, unknown>): void {
    this.log('debug', message, data);
  }

  info(message: string, data?: Record<string, unknown>): void {
    this.log('info', message, data);
  }

  warn(message: string, data?: Record<string, unknown>): void {
    this.log('warn', message, data);
  }

  error(message: string, error?: Error, data?: Record<string, unknown>): void {
    this.log('error', message, data, error);
  }

  setLevel(level: LogLevel): void {
    this.level = level;
  }

  getLevel(): LogLevel {
    return this.level;
  }

  createChild(subModule: string): ILogger {
    const child = new Logger(`${this.module}:${subModule}`);
    child.setLevel(this.level);
    child.transports = [...this.transports];
    return child;
  }

  addTransport(transport: LogTransport): void {
    this.transports.push(transport);
  }

  private log(
    level: LogLevel,
    message: string,
    data?: Record<string, unknown>,
    error?: Error
  ): void {
    if (LOG_LEVELS[level] < LOG_LEVELS[this.level]) {
      return;
    }

    const entry: LogEntry = {
      level,
      message,
      module: this.module,
      timestamp: new Date(),
      data,
      error,
    };

    for (const transport of this.transports) {
      try {
        transport(entry);
      } catch (err) {
        console.error('Log transport error:', err);
      }
    }
  }

  private consoleTransport(entry: LogEntry): void {
    const prefix = `[${entry.timestamp.toISOString()}] [${entry.level.toUpperCase()}] [${entry.module}]`;
    const args: unknown[] = [prefix, entry.message];
    
    if (entry.data) {
      args.push(entry.data);
    }
    
    if (entry.error) {
      args.push(entry.error);
    }

    switch (entry.level) {
      case 'debug':
        console.debug(...args);
        break;
      case 'info':
        console.info(...args);
        break;
      case 'warn':
        console.warn(...args);
        break;
      case 'error':
        console.error(...args);
        break;
    }
  }
}

// 单例导出
export const logger = new Logger();
```

**验收标准**：
- [ ] Logger 类实现完整
- [ ] 支持多级别日志
- [ ] 支持子日志器
- [ ] 支持自定义 transport
- [ ] 单元测试通过

---

#### 1.5.3 SDK 连接服务

**描述**：实现与 SDK 的连接服务

**文件**：`src/renderer/services/SDKService.ts`

```typescript
/**
 * SDK 连接服务
 * 封装与 @chips/sdk 的交互
 */
import { ChipsSDK } from '@chips/sdk';
import type { Card, Box } from '@common/types';
import { logger } from './Logger';
import { eventBus } from './EventBus';
import { EVENTS } from '@common/constants';

export interface SDKServiceOptions {
  autoConnect?: boolean;
  debug?: boolean;
}

export class SDKService {
  private sdk: ChipsSDK | null = null;
  private initialized = false;
  private readonly log = logger.createChild('SDKService');

  /**
   * 初始化 SDK
   */
  async initialize(options: SDKServiceOptions = {}): Promise<void> {
    if (this.initialized) {
      this.log.warn('SDK already initialized');
      return;
    }

    try {
      this.log.info('Initializing SDK...');
      
      this.sdk = new ChipsSDK({
        autoConnect: options.autoConnect ?? true,
        debug: options.debug ?? false,
      });

      await this.sdk.initialize();
      
      this.initialized = true;
      this.log.info('SDK initialized successfully');
      
      eventBus.emit(EVENTS.STATE_CHANGE, { sdkReady: true });
    } catch (error) {
      this.log.error('Failed to initialize SDK', error as Error);
      throw error;
    }
  }

  /**
   * 销毁 SDK
   */
  destroy(): void {
    if (this.sdk) {
      this.sdk.destroy();
      this.sdk = null;
      this.initialized = false;
      this.log.info('SDK destroyed');
    }
  }

  /**
   * 获取 SDK 实例
   */
  getSDK(): ChipsSDK {
    if (!this.sdk) {
      throw new Error('SDK not initialized');
    }
    return this.sdk;
  }

  /**
   * 检查 SDK 是否就绪
   */
  isReady(): boolean {
    return this.initialized && this.sdk?.isReady === true;
  }

  /**
   * 加载卡片
   */
  async loadCard(path: string): Promise<Card> {
    const sdk = this.getSDK();
    return sdk.card.get(path) as Promise<Card>;
  }

  /**
   * 加载箱子
   */
  async loadBox(path: string): Promise<Box> {
    const sdk = this.getSDK();
    return sdk.box.get(path) as Promise<Box>;
  }

  /**
   * 验证卡片
   */
  async validateCard(path: string): Promise<boolean> {
    const sdk = this.getSDK();
    const result = await sdk.file.validateFile(path);
    return result.valid;
  }

  /**
   * 验证箱子
   */
  async validateBox(path: string): Promise<boolean> {
    const sdk = this.getSDK();
    const result = await sdk.file.validateFile(path);
    return result.valid;
  }

  /**
   * 获取文件信息
   */
  async getFileInfo(path: string): Promise<{ exists: boolean; type: string; size: number }> {
    const sdk = this.getSDK();
    const info = await sdk.file.getFileInfo(path);
    return {
      exists: true,
      type: info.type,
      size: info.size,
    };
  }

  /**
   * 通过内核路由请求
   */
  async request<T>(service: string, payload: unknown): Promise<T> {
    const sdk = this.getSDK();
    const response = await sdk.connector.request<T>({
      service,
      payload,
    });
    
    if (!response.success) {
      throw new Error(response.error?.message ?? 'Request failed');
    }
    
    return response.data as T;
  }
}

// 单例导出
export const sdkService = new SDKService();
```

**验收标准**：
- [ ] SDKService 类实现完整
- [ ] 与 SDK 连接正常
- [ ] 支持卡片/箱子加载
- [ ] 支持通用请求方法
- [ ] 单元测试通过

---

#### 1.5.4 服务导出索引

**描述**：创建服务层导出索引

**文件**：`src/renderer/services/index.ts`

```typescript
/**
 * 服务层导出索引
 */

export { EventBus, eventBus } from './EventBus';
export { Logger, logger } from './Logger';
export { SDKService, sdkService } from './SDKService';
export type { SDKServiceOptions } from './SDKService';
```

**验收标准**：
- [ ] 索引文件已创建
- [ ] 所有服务正确导出

---

### 任务 1.6：入口文件创建（0.5天）

#### 1.6.1 渲染进程入口

**描述**：创建渲染进程入口文件

**文件**：`src/renderer/main.ts`

```typescript
/**
 * 渲染进程入口
 */
import { createApp } from 'vue';
import { createPinia } from 'pinia';
import App from './App.vue';
import { sdkService, logger } from './services';

async function bootstrap(): Promise<void> {
  const log = logger.createChild('Bootstrap');
  
  try {
    log.info('Starting Chips Viewer...');
    
    // 初始化 SDK
    await sdkService.initialize({
      autoConnect: true,
      debug: import.meta.env.DEV,
    });
    
    // 创建 Vue 应用
    const app = createApp(App);
    
    // 使用 Pinia 状态管理
    const pinia = createPinia();
    app.use(pinia);
    
    // 挂载应用
    app.mount('#app');
    
    log.info('Chips Viewer started successfully');
  } catch (error) {
    log.error('Failed to start Chips Viewer', error as Error);
    throw error;
  }
}

bootstrap();
```

**验收标准**：
- [ ] main.ts 已创建
- [ ] SDK 初始化正常
- [ ] Vue 应用挂载正常

---

#### 1.6.2 根组件创建

**描述**：创建根组件

**文件**：`src/renderer/App.vue`

```vue
<script setup lang="ts">
/**
 * Chips Viewer 根组件
 */
import { onMounted, onUnmounted, ref } from 'vue';
import { ChipsProvider } from '@chips/components';
import { sdkService, eventBus, logger } from './services';
import { EVENTS } from '@common/constants';

const log = logger.createChild('App');
const isReady = ref(false);
const error = ref<string | null>(null);

onMounted(() => {
  log.info('App component mounted');
  
  // 监听 SDK 就绪状态
  const handlerId = eventBus.on(EVENTS.STATE_CHANGE, (data: { sdkReady?: boolean }) => {
    if (data.sdkReady) {
      isReady.value = true;
      log.info('SDK ready, app is now ready');
    }
  });
  
  // 检查当前状态
  if (sdkService.isReady()) {
    isReady.value = true;
  }
  
  onUnmounted(() => {
    eventBus.off(EVENTS.STATE_CHANGE, handlerId);
  });
});
</script>

<template>
  <ChipsProvider>
    <div class="chips-viewer">
      <!-- 加载中状态 -->
      <div v-if="!isReady" class="chips-viewer__loading">
        <div class="chips-viewer__loading-spinner" />
        <span class="chips-viewer__loading-text">Loading...</span>
      </div>
      
      <!-- 错误状态 -->
      <div v-else-if="error" class="chips-viewer__error">
        <span class="chips-viewer__error-text">{{ error }}</span>
      </div>
      
      <!-- 主内容区 -->
      <div v-else class="chips-viewer__main">
        <!-- 头部导航栏 -->
        <header class="chips-viewer__header">
          <!-- 待实现 -->
        </header>
        
        <!-- 主体区域 -->
        <main class="chips-viewer__content">
          <!-- 待实现 -->
        </main>
        
        <!-- 底部状态栏 -->
        <footer class="chips-viewer__footer">
          <!-- 待实现 -->
        </footer>
      </div>
    </div>
  </ChipsProvider>
</template>
```

**验收标准**：
- [ ] App.vue 已创建
- [ ] 使用 ChipsProvider 包装
- [ ] 基本布局结构完整

---

#### 1.6.3 主进程入口

**描述**：创建 Electron 主进程入口

**文件**：`src/main/index.ts`

```typescript
/**
 * Electron 主进程入口
 */
import { app, BrowserWindow, ipcMain } from 'electron';
import { join } from 'path';
import { IPC_CHANNELS } from '@common/constants';

let mainWindow: BrowserWindow | null = null;

/**
 * 创建主窗口
 */
function createWindow(): void {
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    minWidth: 800,
    minHeight: 600,
    title: 'Chips Viewer',
    webPreferences: {
      preload: join(__dirname, '../preload/index.js'),
      nodeIntegration: false,
      contextIsolation: true,
      sandbox: false,
    },
    show: false,
  });

  // 开发模式加载 localhost，生产模式加载打包文件
  if (process.env.NODE_ENV === 'development') {
    mainWindow.loadURL('http://localhost:5173');
    mainWindow.webContents.openDevTools();
  } else {
    mainWindow.loadFile(join(__dirname, '../renderer/index.html'));
  }

  // 窗口准备好后显示
  mainWindow.once('ready-to-show', () => {
    mainWindow?.show();
  });

  // 窗口关闭时清理
  mainWindow.on('closed', () => {
    mainWindow = null;
  });
}

/**
 * 设置 IPC 处理器
 */
function setupIPC(): void {
  // 窗口操作
  ipcMain.on(IPC_CHANNELS.WINDOW_MINIMIZE, () => {
    mainWindow?.minimize();
  });

  ipcMain.on(IPC_CHANNELS.WINDOW_MAXIMIZE, () => {
    if (mainWindow?.isMaximized()) {
      mainWindow.unmaximize();
    } else {
      mainWindow?.maximize();
    }
  });

  ipcMain.on(IPC_CHANNELS.WINDOW_CLOSE, () => {
    mainWindow?.close();
  });

  ipcMain.on(IPC_CHANNELS.WINDOW_FULLSCREEN, () => {
    mainWindow?.setFullScreen(!mainWindow.isFullScreen());
  });
}

// 应用启动
app.whenReady().then(() => {
  setupIPC();
  createWindow();

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
      createWindow();
    }
  });
});

// macOS 以外的平台，所有窗口关闭时退出应用
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit();
  }
});
```

**验收标准**：
- [ ] 主进程入口已创建
- [ ] 窗口创建正常
- [ ] IPC 通道设置正确

---

#### 1.6.4 预加载脚本

**描述**：创建预加载脚本

**文件**：`src/main/preload/index.ts`

```typescript
/**
 * 预加载脚本
 * 在渲染进程中安全暴露 API
 */
import { contextBridge, ipcRenderer } from 'electron';
import { IPC_CHANNELS } from '@common/constants';

// 暴露给渲染进程的 API
const electronAPI = {
  // 窗口操作
  window: {
    minimize: () => ipcRenderer.send(IPC_CHANNELS.WINDOW_MINIMIZE),
    maximize: () => ipcRenderer.send(IPC_CHANNELS.WINDOW_MAXIMIZE),
    close: () => ipcRenderer.send(IPC_CHANNELS.WINDOW_CLOSE),
    fullscreen: () => ipcRenderer.send(IPC_CHANNELS.WINDOW_FULLSCREEN),
  },
  
  // 文件操作
  file: {
    openDialog: () => ipcRenderer.invoke(IPC_CHANNELS.FILE_OPEN_DIALOG),
    getRecent: () => ipcRenderer.invoke(IPC_CHANNELS.FILE_RECENT),
  },
  
  // 平台信息
  platform: process.platform,
};

// 安全暴露 API
contextBridge.exposeInMainWorld('electronAPI', electronAPI);

// 类型声明
declare global {
  interface Window {
    electronAPI: typeof electronAPI;
  }
}
```

**验收标准**：
- [ ] 预加载脚本已创建
- [ ] API 安全暴露
- [ ] 类型声明正确

---

### 任务 1.7：HTML 入口和基础样式（0.5天）

#### 1.7.1 HTML 入口文件

**描述**：创建 HTML 入口文件

**文件**：`index.html`

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
  <title>Chips Viewer</title>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="/src/renderer/main.ts"></script>
</body>
</html>
```

**验收标准**：
- [ ] index.html 已创建
- [ ] CSP 策略配置正确
- [ ] 入口脚本引用正确

---

## 阶段完成标准

### 必须完成项

- [ ] 所有目录结构创建完成
- [ ] Git 子仓库初始化完成
- [ ] 所有配置文件创建完成
- [ ] 类型定义完成
- [ ] 常量和接口定义完成
- [ ] 基础服务层实现完成
- [ ] 入口文件创建完成
- [ ] 项目可以启动并显示空白界面

### 质量要求

- [ ] TypeScript 类型检查通过
- [ ] ESLint 检查通过
- [ ] 基础服务单元测试通过
- [ ] 代码注释完整

### 提交记录

完成后应有以下 Git 提交：
1. `feat: 初始化项目结构和配置文件`
2. `feat: 添加核心类型定义`
3. `feat: 添加常量和接口定义`
4. `feat: 实现基础服务层`
5. `feat: 创建入口文件和基础组件`

---

**下一阶段**：Phase 2 - 核心模块开发
